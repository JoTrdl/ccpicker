/*! CcPicker - v0.9 - 2013-12-01
 * https://github.com/JoTrdl/ccpicker
 *
 * Copyright (c) 2013 Johann Troendle <johann.troendle@gmail.com>;
 * Licensed under the MIT license */
!function(a,b,c){"use strict";var i,j,k,l,m,n,o,p,q,r,d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwH+YwCGIasIUwhT25BVBADtzYNYrHvv4gAAAABJRU5ErkJggg==",e=!!("ontouchstart"in window),f={start:e?"touchstart":"mousedown",move:e?"touchmove":"mousemove",end:e?"touchend":"mouseup"},g=!1,h=function(a,b,c){return{x:Math.round(a.x+Math.cos(b)*c),y:Math.round(a.y+Math.sin(b)*c)}},s=2*Math.PI,t=Math.PI/2,u=Math.PI/12,v=23*Math.PI/12,w=Math.PI/12,x=23/12*Math.PI,y=["red","purple","#8000FF","blue","cyan","green","yellow","orange"],z={width:2,color:"rgb(176,176,176)"},A={hue:{elem:null,active:!1},color:{elem:null,active:!1},alpha:{elem:null,active:!1}},B=function(a,b,c,d){a.save(),a.lineWidth=c;var e,f,g;e=h(n,0,b);for(var i=s/d.length,j=s/360,k=0,l=0;k<d.length;k++,l+=i)f=h(n,l+i,b),g=a.createLinearGradient(e.x,e.y,f.x,f.y),g.addColorStop(0,d[k]),g.addColorStop(1,d[k+1]||d[0]),a.strokeStyle=g,a.beginPath(),a.arc(n.x,n.y,b,l-j,l+i+j),a.stroke(),e=f;a.lineWidth=2,a.shadowBlur=0,a.shadowColor="rgb(100,100,100)",a.strokeStyle="rgb(176,176,176)",a.beginPath(),a.arc(n.x,n.y,b+c/2+1,0,2*Math.PI),a.beginPath(),a.arc(n.x,n.y,b-c/2,0,2*Math.PI),a.restore()},C=function(a,b,c){var e,f=function(){a.save(),a.translate(n.x,n.y),a.rotate(-Math.PI/2),a.translate(-n.x,-n.y),a.lineCap="round",a.lineWidth=c+2,a.strokeStyle=z.color,a.beginPath(),a.arc(n.x,n.y,b,w,x),a.stroke(),a.lineWidth=c,a.strokeStyle=e,a.beginPath(),a.arc(n.x,n.y,b,w,x),a.stroke();var d=2*(b+c/2),f=b+c/2,g=a.createLinearGradient(n.x-b,n.y+f/2,n.x+b,n.y+f/2);g.addColorStop(0,"rgba(74, 134, 232, .5)"),g.addColorStop(1,"rgba(74, 134, 232, 0)");var h=a.createLinearGradient(n.x-b,n.y+f/2,n.x+b,n.y+f/2);h.addColorStop(0,"rgba(74, 134, 232, .5)"),h.addColorStop(1,"rgba(74, 134, 232, 1)"),a.save(),a.beginPath(),a.rect(n.x-b-c/2,n.y,d,f),a.clip(),a.strokeStyle=g,a.beginPath(),a.arc(n.x,n.y,b,w,x),a.stroke(),a.restore(),a.save(),a.beginPath(),a.rect(n.x-b-c/2,n.y-b-c/2,d,f),a.clip(),a.strokeStyle=h,a.beginPath(),a.arc(n.x,n.y,b,w,x),a.stroke(),a.restore(),a.restore()},g=new Image;g.onload=function(){e=a.createPattern(g,"repeat"),f()},g.src=d},D=function(a){var c=b.createElement("canvas");c.width=k,c.height=l,c.style.position="relative",c.style.zIndex="1",a.appendChild(c),i=c.getContext("2d"),c=b.createElement("canvas"),c.width=k,c.height=l,c.style.display="none",a.appendChild(c),j=c.getContext("2d"),j.translate(n.x,n.y),j.rotate(Math.PI/4+Math.PI/2),j.translate(-n.x,-n.y),q=b.createElement("div"),q.style.position="absolute",q.style.borderRadius="100%",q.style.webkitTouchCallout="none",q.style.webkitUserSelect="none",q.style.khtmlUserSelect="none",q.style.mozUserSelect="none",q.style.msUserSelect="none",q.style.userSelect="none",q.style.border="1px solid "+z.color,q.style.zIndex=5,q.style.width=.3*k+"px",q.style.height=.3*l+"px",q.style.left=n.x-.3*k/2-1+"px",q.style.top=n.y-.3*l/2-1+"px",a.appendChild(q),c=q.cloneNode(),c.border="none",c.style.zIndex=0,c.style.background="url("+d+")",a.appendChild(c),r=q.cloneNode(),r.style.border=m+"px solid red",r.style.background="none",r.style.zIndex=0,a.appendChild(r);var e=function(){var a=b.createElement("div");return a.classname="knob",a.innerText="+",a.style.position="absolute",a.style.borderRadius="100%",a.style.boxShadow="rgba(90, 90, 90, 1) 0px 0px 0px 2px, rgba(85, 85, 85, 0.65098) 0px 2px 40px 2px inset",a.style.textAlign="center",a.style.lineHeight=2*p+"px",a.style.fontSize="40px",a.style.color="rgba(85, 85, 85, 1)",a.style.webkitUserSelect="none",a.style.khtmlUserSelect="none",a.style.mozUserSelect="none",a.style.msUserSelect="none",a.style.userSelect="none",a.style.cursor="pointer",a.style.zIndex="2",a.style.width=2*p+"px",a.style.height=2*p+"px",a};A.hue.elem=e(),a.appendChild(A.hue.elem),A.color.elem=e(),a.appendChild(A.color.elem),A.alpha.elem=e(),a.appendChild(A.alpha.elem)},E=function(a,b){if(!a)return console.log("container must be defined"),void 0;var d=1,w=[255,0,0];k=b&&b.width||a.offsetWidth,l=b&&b.height||a.offsetHeight,m=Math.ceil(b&&b.lineWidth||.08*k+1),n={x:k/2,y:l/2},o=k/2-m/2-z.width,p=(m+10)/2>>0,D(a),B(i,o,m,y);var x=b&&b.callback||function(){},E=(o-m/2-.3*(k/2)-2*m)/3,F=.3*k/2+m/2+E;C(i,F,m);var G=Math.ceil(F+m+E);r.style.width=r.style.height=Math.ceil(2*G-m+2)+"px",r.style.left=Math.floor(n.x-G-m/2-1)+"px",r.style.top=Math.floor(n.y-G-m/2-1)+"px",B(j,G,m,["black","red","red","white"]),i.save(),i.translate(n.x,n.y),i.rotate(Math.PI/4+Math.PI/2),i.translate(-n.x,-n.y),B(i,G,m+2,["black","rgba(0,0,0,0)","rgba(255,255,255,0)","white"]),i.restore();var H=function(a,b){a.style.left=b.x-p+"px",a.style.top=b.y-p+"px"},I=h(n,0,o);H(A.hue.elem,I),I=h(n,-Math.PI/2,G),H(A.color.elem,I),I=h(n,23/12*Math.PI-Math.PI/2,F),H(A.alpha.elem,I);var J=function(a){if(A.hue.active){a.preventDefault();var b=e?a.touches.item(0):a,c=Math.atan2(b.clientY-n.y,b.clientX-n.x),f=h(n,c,o);H(A.hue.elem,f),w=i.getImageData(f.x,f.y,1,1).data;var g="rgb("+w[0]+","+w[1]+","+w[2]+")";r.style.borderColor=g}else if(A.color.active){a.preventDefault();var b=e?a.touches.item(0):a,c=Math.atan2(b.clientY-n.y,b.clientX-n.x),f=h(n,c,G);H(A.color.elem,f),w=j.getImageData(f.x,f.y,1,1).data}else if(A.alpha.active){a.preventDefault();var b=e?a.touches.item(0):a,c=Math.atan2(b.clientY-n.y,b.clientX-n.x);c+=t,0>c&&(c=s+c),u>c?c=u:c>v&&(c=v);var f=h(n,c-t,F);H(A.alpha.elem,f),d=Math.abs(c/v).toFixed(2)}var g="rgba("+w[0]+","+w[1]+","+w[2]+","+d+")";q.style.backgroundColor=g},K=function(b){if(b.preventDefault(),A.hue.active){var e="rgb("+w[0]+","+w[1]+","+w[2]+")";B(j,G,m,["black",e,e,"white"])}A.hue.active=A.color.active=A.alpha.active=!1;var e="rgba("+w[0]+","+w[1]+","+w[2]+","+d+")";g?c(a).trigger("change",[e]):x(e)},L={start:{hue:function(a){a.preventDefault(),A.hue.active=!0},color:function(a){a.preventDefault(),A.color.active=!0},alpha:function(a){a.preventDefault(),A.alpha.active=!0}},move:J,end:K};return A.hue.elem.addEventListener(f.start,L.start.hue),A.color.elem.addEventListener(f.start,L.start.color),A.alpha.elem.addEventListener(f.start,L.start.alpha),document.addEventListener(f.move,L.move),document.addEventListener(f.end,L.end),{}};a.CCPicker=E,"function"==typeof c&&(c.fn.ccpicker=function(a){return g=!0,this.each(function(){var b=c(this),d=b.data("ccpicker");d||b.data("ccpicker",new E(this,a||{}))})})}(window,document,window.jQuery||window.Zepto);